{% extends "base.html" %} 

{% load static %}
{% block styles %}
  <link rel="stylesheet" type="text/css" href="{% static 'offers/outlook.css' %}">
{% endblock styles %}

{% block title %}
{{object.title}} - {{block.super}}
{% endblock title %}
  
{% block content %}

  <div class="container">

  {% if object.offer_status == 'Cancelled' %}
    <h1>This offer has been cancelled by the owner.</h1>
  {% elif object.offer_status == 'Passive' %}
    <h1>This offer has finished.</h1>
  {% endif %}

    {% if object.image %}
      <div class="first-column">
        <style>
          .first-column {
            background-image: url('{{object.image.url}}');
            background-repeat: no-repeat;
          }
        </style>
    {% endif %}
      <div class="profile-picture">
          <!-- interest --> 
        <div class="title">
          <h1> {{object.title}} </h1>
        </div>
      </div>
    </div>
    <div class="second-column">
      <div class="first-part">
        <h1 class="about-me">Offer description</h1>
      </div>
      <div class="second-part">
        <h3> {{object.description}} </h3>
      </div>
    </div>
    {% if object.image %}
      <div class="info-column">
        <style>
          .info-column {
            background-image: url('{{object.image.url}}');
            background-repeat: no-repeat;
          }
        </style>
    {% endif %}
      <div class="layer">
        <div class="theContainer">
          <div class="info-part">
            <h1>Offer details</h1>
              <h3>Offer type:</h3>
                <p> {{object.offer_type}} </p>
              <h3>Offer format:</h3>
                <p> {{object.offer_format}} </p>
                <h3>Location:</h3>
                <p> {{object.loc_long}}, {{object.loc_ltd}} </p>
              <h3>Starting date:</h3>
                <p> {{object.start_date|date:'j-M-Y, g A (e)'}} </p>
              <h3>Ending date:</h3>
                <p> {{object.end_date|date:'j-M-Y, g A (e)'}} </p>
              <h3>Required credits:</h3>
                <p> {{object.credit}} </p>
              <h3>Capacity:</h3>
                <p> {{object.capacity}} </p>
              <h3>Number of spots left:</h3>
                <p> {{spots_left}} </p>
              <h3>Application deadline:</h3>
                <p> {{object.app_deadline|date:'j-M-Y, g A (e)'}} </p>
              <h3>Cancellation deadline:</h3>
                <p> {{object.cancel_deadline|date:'j-M-Y, g A (e)'}} </p>
          </div>
        
        {% if object.offer_status == 'Active' %}
          {% if object.owner.id != request.user.profile.id %}
          <div class="button-parts">
            <button class="save-button" type="button">
              <a href="{%url 'profile_look' pk=object.owner.id %}">Offerer's profile!</a>
            </button>
            {% if join_request != None %}
              <button class="save-button" type="button">
                <a href="{%url 'cancel_join_request' join_request_id=join_request.id %}">Cancel request!</a>
              </button>
            {% elif request.user.profile in participants %}
              <button class="save-button" type="button">
                <a href="{%url 'leave_offer' offerID=object.id %}">Leave offer!</a>
              </button>
            {% else %}
              {% if object.capacity > participants.count %}
                <button class="save-button" type="button">
                  <a href="{%url 'send_join_request' offerID=object.id %}">Apply!</a>
                </button>
              {% else %}
                <h2>This offer is full!</h2>
              {% endif %}
            {% endif %}
          {% else %}
            <button class="save-button" type="button">
              <a href="{%url 'cancel_offer' offerID=object.id %}">Cancel offer!</a>
            </button>
            <div>
              <h4>Participants</h4>
                {% for obj in participants %}
                  <a href="{%url 'profile_look' pk=obj.id %}">{{obj.f_name}} {{obj.l_name}}</a>
                {% endfor %}
            </div>
          {% endif %}
        {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock content %}